# PVE Commander - Ansible Konfiguration
# Optimiert fuer schnelle Playbook-Ausfuehrung

[defaults]
# Parallelitaet - Anzahl gleichzeitiger Hosts
forks = 10

# Remote Temp-Verzeichnis (verhindert Warning bei become)
remote_tmp = /tmp/.ansible-${USER}/tmp

# World-readable temp files (fuer pipelining mit become)
allow_world_readable_tmpfiles = True

# Fact Gathering optimieren
gathering = smart
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_facts_cache
fact_caching_timeout = 3600

# Host Key Checking deaktivieren (VMs werden dynamisch erstellt)
host_key_checking = False

# Farbige Ausgabe
force_color = True

# Interpreter Discovery (schneller als auto)
interpreter_python = auto_silent

# Stdout Callback - default weil yaml community.general erfordert
# stdout_callback = yaml

# Retry-Dateien deaktivieren
retry_files_enabled = False

# Wartezeit zwischen Tasks reduzieren
internal_poll_interval = 0.001

[ssh_connection]
# Pipelining aktivieren - drastisch schneller (nur mit become_method=sudo)
pipelining = True

# SSH ControlPersist - Verbindungen wiederverwenden
ssh_args = -o ControlMaster=auto -o ControlPersist=60s -o PreferredAuthentications=publickey

# Transfer-Methode
transfer_method = smart

# Retries bei SSH-Verbindungsproblemen
retries = 3

[privilege_escalation]
# Sudo ohne TTY (erforderlich fuer pipelining)
become_flags = -H -S

[persistent_connection]
# Timeout fuer persistente Verbindungen
connect_timeout = 30
command_timeout = 30
